---
pagination:
  data: products
  size: 1
  alias: product
permalink: "/products/{{ product.name }}/index.html"
---

{% extends "layouts/base.njk" %}

{% block content %}

<h1>{{ product.name }}</h1>

<div
    x-data="shop" 
    x-effect="syncCart"
    class="shop__container grid-layout">

    <button
      x-cloak 
      @click="openCart()">
      view cart 
      <span x-text="totalProducts"></span>
    </button>


    {% for item in product.sizes %}
        <button 
            x-cloak
            @click="addToCart($el.dataset)" 
            data-priceid="{{ item.priceId }}"
            data-name="{{ item.name }}"
            data-quantity="1"
            data-id= {{item.id}}>
            Add to cart {{item.name}}
        </button>
    {% endfor %}

    <dialog data-cart>
        <p><span x-text="totalProducts"></span> products in your cart</p>
        <template 
          x-for="(item, index) in products" 
          :key="item.id">
          <div>
            <h2 x-text="item.name"></h2>
            <p>
              Quantity: 
              <input 
                type="number" 
                min="1" 
                max="10" 
                value="item.quantity" 
                x-model.number="item.quantity" />
              <button @click="deleteFromCart(item.id)">Delete</button>
            </p>
          </div>
        </template>
        <p>
          <button @click="closeCart">Continue Shopping</button>
          <button x-show="products.length" @click="checkout">Checkout</button>
          <button @click="updateProductQuantity">success</button>
        </p>
      </dialog>

</div>

{% endblock %}